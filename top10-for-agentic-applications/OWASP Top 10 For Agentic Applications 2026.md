# Agentic Top 10 リーダーからのメッセージ

エージェント型 AI システムは、金融、医療、防衛、重要インフラ、公共部門など、様々な分野でパイロット段階から本番環境へと急速に移行しています。タスク固有の自動化とは異なり、エージェントは複数のステップとシステムにわたって計画、決定、行動を行い、多くの場合、ユーザーやチームに代わって行動します。Agentic Security Initiative は、既にエージェント型アプリケーションの安全対策の定義を開始しており、ライフサイクル全体にわたる一連のガイドラインを公開しています。

私たちの核となる分類（Agentic AI - Threats and Mitigations）は、エージェントの基本的な定義、LLM アプリケーションとの関係、自律性の役割、そして脅威と軽減策の詳細な取り扱いを示しています。その他の文書には、脅威モデリング（Agentic Threat Modelling Guide）、エージェント型アプリケーションのアーキテクチャ、設計、開発、デプロイメントのセキュリティ確保（Securing Agentic Applications）、そしてガバナンス（State of Agentic AI Security and Governance）が含まれています。

これらの出版物は、参考資料として、また詳細な解説として、包括的なガイドラインを提供しています。しかしながら、その範囲が広範であるため、開発者、防御者、意思決定者にとって、日常業務への適用は困難です。

OWASP Agentic Top 10 for Agentic Applications（OWASP Agentic Top 10）は、セキュリティ リーダーや実務者が、最も影響の大きい脅威上位 10 個を理解し、対処し、取り組みを開始するための羅針盤であり、頼りになる参考情報です。

本書は、標準的で広く普及している OWASP Top 10 形式を採用し、簡潔で実用的かつ実用的なガイダンスを提供しています。各項目には、簡単な説明、一般的な脆弱性、シナリオ例、そして最も重要な点として、チームが今日から導入を開始できる実用的な軽減策が記載されています。

私たちは、既存のガイダンスを簡素化し連携させることを目指しており、重複するガイダンスを増やすことに貢献するものではありません。この Top 10は 、Agentic AI - Threats and Mitigations に基づいており、これは私たちの基礎となる詳細な分類体系です。

私たちはエージェント アプリケーションに焦点を当てていますが、エージェント アプリケーションは単独で存在するものではなく、LLM アプリケーションの開発の一部となります。そのため、私たちの項目は、OWASP Top 10 for LLM Applications およびその他の関連標準を参考にしています。これらには、その他のさまざまな OWASP Top 10、CycloneDX 標準、Top 10 for Non-Human Identities (NHI),、そしてスコアリングと優先順位付けのための OWASP AI Vulnerability Scoring System (AIVSS) が含まれます。

エージェントは既存の脆弱性を増幅させます。最小権限と過剰な主体性の概念を、最小限の主体性に言及することでさらに詳しく説明します。これは、組織に対して不必要な自律性を避けるようにというアドバイスをまとめたものです。不要な場所にエージェントの行動を導入すると、付加価値を与えることなく攻撃対象領域を拡大するだけです。同様に、強力な可観測性は譲れないものとなります。エージェントが何を実行し、なぜ実行し、どのツールを呼び出しているかを明確に把握できなければ、不必要な自律性によって攻撃対象領域がひそかに拡大し、軽微な問題がシステム全体の障害につながる可能性があります。

本書は、世界的な OWASP コミュニティの成果物です。業界、学界、政府機関の数十人のセキュリティ専門家が、エージェント型プラットフォームを構築する組織、公的機関、製品ベンダーの支援を受けて、脅威調査、レッド チームの調査結果、そしてフィールド テスト済みの軽減策を提供しました。

謝辞セクションには、エントリー リード、貢献者、著名な専門家によるレビュー委員会、そしてレビューに参加してくださった組織のリストが掲載されており、多様な実世界の知見を取り入れることができました。

私たちは、これらの方々に感謝し、OWASP の専門家主導のコミュニティ主導のアプローチ、すなわちオープンなコラボレーション、ピア レビュー、そして研究、エクスプロイト、インシデント、そして実世界の導入における課題からのエビデンスを活用して、今後も進化を続けていきます。


敬具

John Sotiropoulos、OWASP GenAI Security Project 理事、ASI 共同リーダー、Agentic Top 10 議長

Keren Katz、Agentic Top 10 リーダー、OWASP GenAI Security Project - ASI コアチーム

Ron F. Del Rosario、OWASP GenAI Security Project コア チーム メンバー、ASI 共同リーダー

# Agentic Top 10 一覧

<div align="center">

![ASI_Top10.png](./_resources/ASI_Top10.png)


<table border="0">
<tr>
<td width="20%"><b>ASI01:</b> エージェント目標の乗っ取り</td>
<td width="20%"><b>ASI03:</b> アイデンティティーおよび権限の乱用</td>
<td width="20%"><b>ASI05:</b> 予期せぬコード実行 (RCE)</td>
<td width="20%"><b>ASI07:</b> セキュアでないエージェント間通信</td>
<td width="20%"><b>ASI09:</b> 人間とエージェント間の信頼の悪用</td>
</tr>
<tr>
<td width="20%"><b>ASI02:</b> ツールの不正使用および悪用</td>
<td width="20%"><b>ASI04:</b> エージェント型サプライチェーンの脆弱性</td>
<td width="20%"><b>ASI06:</b> 記憶およびコンテキストの汚染</td>
<td width="20%"><b>ASI08:</b> 連鎖的な失敗</td>
<td width="20%"><b>ASI10:</b> 不正エージェント</td>
</tr>
</table>

</div>

# ASI01: エージェント目標の乗っ取り (Agent Goal Hijack)

## 解説

AI エージェントは、目標を達成するために一連のタスクを自律的に実行する能力を発揮します。自然言語による指示と関連コンテンツの処理方法には固有の弱点があるため、エージェントとその基盤となるモデルは、指示と関連コンテンツを確実に区別することができません。

その結果、攻撃者は、プロンプト ベースの操作、欺瞞的なツール出力、悪意のあるアーティファクト、偽造されたエージェント間メッセージ、改ざんされた外部データなど、様々な手法を用いて、エージェントの目標、タスク選択、または意思決定経路を操作することができます。エージェントは、型付けされていない自然言語入力と緩く管理されたオーケストレーション ロジックに依存しているため、正当な指示と攻撃者が制御するコンテンツを確実に区別することはできません。単一のモデル応答の変更に焦点を当てた **LLM01:2025** とは異なり、ASI01は、操作された入力によって目標の変更、計画策定（使用された場合）、および複数段階の動作が行われる、より広範なエージェントの影響を対象としています。

エージェント目標の乗っ取りは、**ASI06**（記憶およびコンテキストの汚染）や **ASI10**（不正エージェント）とは異なります。これは、攻撃者が、エージェントの目標、指示、または意思決定経路を直接変更する点です。これは、操作が対話的に行われるか、文書、テンプレート、外部データ ソースなどの事前設定された入力を介して行われるかに関わらず行われます。**ASI06** は、保存されたコンテキストまたは長期記憶の永続的な破損に焦点を当てていますが、**ASI10** は、攻撃者の能動的な制御なしに発生する自律的な不整合を対象としています。OWASP Agentic AI Threats & Mitigations Guide では、**ASI01** は **T06** 目標の操作（エージェント目標を変更します）および **T07** 不整合で欺瞞的な振舞い（安全策を回避したり人間を欺したります）に相当します。これらは、攻撃者がエージェントの目標と行動選択ロジックを破壊し、その自律性を意図しない、あるいは有害な結果へと誘導する方法を示しています。

## 脆弱性の一般的な例

1. RAG シナリオにおいて、Web ページや文書に埋め込まれた隠し命令ペイロードを介した間接プロンプト インジェクションは、エージェントをサイレントにリダイレクトし、機密データを盗み出したり、接続ツールを悪用したりします。
2. 社外から送信された間接プロンプト インジェクションの外部通信チャネル（メール、カレンダー、チームなど）は、エージェントの内部通信機能を乗っ取り、信頼されたアイデンティティーを使用して不正なメッセージを送信します。
3. 悪意のあるプロンプト オーバーライドは、金融エージェントを操作して攻撃者の口座に送金させます。
4. 間接プロンプト インジェクションは、エージェントの指示をオーバーライドし、ビジネス上の意思決定に影響を与える不正な情報を生成します。

## 攻撃シナリオの例

1. **EchoLeak: ゼロクリック間接プロンプト インジェクション** - 攻撃者は細工したメッセージをメールで送信し、Microsoft 365 Copilot に隠された命令をサイレントに実行させます。これにより、AI はユーザーの操作なしに機密メール、ファイル、チャットログを盗み出します。
2. **Web コンテンツを介した Operator プロンプト インジェクション**: 攻撃者は、Operator エージェントが処理する Web ページ（検索や RAG シナリオなど）に悪意のあるコンテンツを埋め込み、Operator エージェントを騙して不正な命令を実行させます。Operator エージェントは認証された内部ページにアクセスし、ユーザーの個人データを公開します。これは、セキュリティが緩い自律エージェントがプロンプト インジェクションを通じて機密情報を漏洩できることを示しています。
3. **スケジュールされたプロンプトを介した目標ロックのドリフト**。悪意のあるカレンダー招待によって、毎朝の目標の重み付けを微妙に調整する「静かなモード」の指示が繰り返し挿入されます。これにより、プランナーは宣言されたポリシーの範囲内でアクションを実行しながら、摩擦の少ない承認へと誘導されます。
4. **ChatGPT ユーザーに対するインセプション攻撃**。悪意のある Google ドキュメントが ChatGPT にユーザー データを盗み出すための指示を注入し、ユーザーにビジネス上不適切な意思決定を促します。

## 防止策および軽減策のガイドライン

1. **すべての自然言語入力**（例: ユーザー入力のテキスト、アップロードされた文書、取得したコンテンツ）を
**信頼できないものとして扱います**。目標の選択、計画、またはツールの呼び出しに影響を与える前に、**LLM01:2025** で定義されているのと同じ入力検証およびプロンプト インジェクションの安全対策を経由させます。
2. エージェント ツールに最小権限を適用し、影響の大きいアクションや目標を変更するアクションには人間の承認を求めることで、目標の乗っ取りの**影響を最小限に抑えます**。
3. **エージェント システムのプロンプトを定義してロックし**、目標の優先順位と許可されたアクションが明確かつ監査可能になるようにします。目標または報酬の定義の変更は、構成管理と人間の承認を経ることを必須とします。
4. **実行時に、目標を変更するアクションや影響の大きいアクションを実行する前に、ユーザーの意図とエージェントの意図の両方を検証します**。エージェントが元のタスクまたはスコープから逸脱するアクションを提案する場合は、必ず人間の承認、ポリシー エンジン、またはプラットフォームのガードレールを介して確認を求めます。予期しない目標変更があった場合は、実行を一時停止またはブロックし、逸脱を表面化させてレビューし、監査のために記録します。
5. エージェントを構築する際には、**「インテント カプセル」** の使用を評価します。これは、宣言された目標、制約、コンテキストを署名付きエンベロープ内の各実行サイクルにバインドし、実行時の使用を制限する**新しいパターン**です。
6. RAG 入力、メール、カレンダー招待、アップロードされたファイル、外部 API、ブラウジング出力、ピア エージェント メッセージなど**接続されたすべてのデータ ソース**を、CDR、プロンプト キャリア検出、コンテンツ フィルタリングを使用して**無害化および検証し**、データがエージェントの目標やアクションに影響を与える前に検証します。
7. **エージェントの活動に関する包括的なログ記録と継続的な監視を維持し**、目標の状態、ツールの使用パターン、不変のプロパティ（スキーマ、アクセス パターンなど）を含む行動ベース ラインを確立します。可能な限り、アクティブな目標の安定した識別子を追跡し、予期しない目標の変更、異常なツール シーケンス、確立されたベース ラインからのずれなど、あらゆる逸脱についてアラートを発することで、不正な目標の逸脱が運用中に直ちに可視化されます。
8. **目標の上書きをシミュレートするレッド チーム テストを定期的に実施し**、ロール バックの有効性を検証します。
9. **確立された内部脅威対策プログラムに AI エージェントを組み込み**、機密データへのアクセスやエージェントの行動の変更を目的とした内部関係者によるプロンプトを監視し、異常なアクティビティが発生した場合に調査できるようにします。

## 参考情報

1. [Security Advisory - ChatGPT Crawler Reflective DDOS Vulnerability: Security advisory detailing the vulnerability]()
2. [AIM Echoleak Blog Post: Blog post describing the vulnerability]()
3. [ChatGPT Plugin Exploit Explained: From Prompt Injection to Accessing Private Data.]()
4. [AgentFlayer: 0click inception attack on ChatGPT users.]()

# ASI02: ツールの不正使用および悪用 (Tool Misuse and Exploitation)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI03: アイデンティティーおよび権限の乱用 (Identity and Privilege　Abuse)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI04: エージェント型サプライチェーンの脆弱性 (Agentic Supply Chain　Vulnerabilities)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI05: 予期せぬコード実行 (RCE) (Unexpected Code Execution (RCE))

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI06: 記憶およびコンテキストの汚染 (Memory & Context Poisoning)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI07: セキュアでないエージェント間通信 (Insecure Inter-Agent Communication)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI08: 連鎖的な失敗 (Cascading Failures)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI09: 人間とエージェント間の信頼の悪用 (Human-Agent Trust Exploitation)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報



# ASI10: 不正エージェント (Rogue Agents)

## 解説

## 脆弱性の一般的な例

## 攻撃シナリオの例

## 防止策および軽減策のガイドライン

## 参考情報







